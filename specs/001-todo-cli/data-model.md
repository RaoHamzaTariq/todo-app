# Data Model: In-Memory Todo CLI

**Feature**: 001-todo-cli | **Last Updated**: 2025-12-29

## Entities

### Task

The primary data entity representing a todo item.

```python
from dataclasses import dataclass
from enum import Enum
from typing import Literal


class TaskStatus(Enum):
    """Enumeration of possible task states."""

    PENDING = "Pending"
    COMPLETED = "Completed"


@dataclass
class Task:
    """Represents a single todo task.

    Attributes:
        id: Unique integer identifier (auto-generated by TodoManager)
        title: Required string representing the task name (max length: 255)
        description: Optional string providing additional details (max length: 1000)
        status: Current state of the task (Pending or Completed)
    """

    id: int
    title: str
    description: str
    status: TaskStatus
```

### Field Definitions

| Field | Type | Constraints | Validation |
|-------|------|-------------|------------|
| `id` | `int` | Unique, positive | Auto-generated by `TodoManager._next_id` |
| `title` | `str` | Required, 1-255 chars | `ValueError` if empty or whitespace only |
| `description` | `str` | Optional, 0-1000 chars | Default: empty string `""` |
| `status` | `TaskStatus` | Enum: PENDING/COMPLETED | Default: `TaskStatus.PENDING` |

## Storage Design

### TodoManager

Central in-memory storage mechanism for Task entities.

```python
from typing import Optional


class TodoManager:
    """Manages Task entities with in-memory storage.

    Attributes:
        _tasks: List of Task instances (in-memory)
        _next_id: Next available integer ID for new tasks
    """

    def __init__(self) -> None:
        """Initialize with empty in-memory storage."""
        self._tasks: list[Task] = []
        self._next_id: int = 1

    # CRUD Operations

    def add_task(self, title: str, description: str = "") -> Task:
        """Create and store a new task.

        Args:
            title: Task title (required, non-empty)
            description: Optional task description

        Returns:
            The created Task instance

        Raises:
            ValueError: If title is empty or whitespace only
        """

    def list_tasks(self) -> list[Task]:
        """Retrieve all tasks ordered by ID.

        Returns:
            List of all tasks, ordered by id ascending
        """

    def get_task(self, task_id: int) -> Optional[Task]:
        """Retrieve a task by ID.

        Args:
            task_id: The integer ID of the task

        Returns:
            Task if found, None otherwise
        """

    def update_task(
        self,
        task_id: int,
        title: Optional[str] = None,
        description: Optional[str] = None,
    ) -> Optional[Task]:
        """Update an existing task's title and/or description.

        Args:
            task_id: The integer ID of the task to update
            title: New title (if provided)
            description: New description (if provided)

        Returns:
            Updated Task if found, None otherwise

        Raises:
            ValueError: If title is provided but empty
        """

    def delete_task(self, task_id: int) -> bool:
        """Delete a task by ID.

        Args:
            task_id: The integer ID of the task to delete

        Returns:
            True if task was deleted, False if not found
        """

    def toggle_complete(self, task_id: int) -> Optional[Task]:
        """Toggle task status between Pending and Completed.

        Args:
            task_id: The integer ID of the task

        Returns:
            Updated Task if found, None otherwise
        """
```

## State Transitions

### Task Status Lifecycle

```
[PENDING] --toggle_complete()--> [COMPLETED]
   ^                              |
   |                              |
   +-------- toggle_complete() ----+
```

- New tasks start in `PENDING` status
- `toggle_complete()` switches between `PENDING` and `COMPLETED`
- Status persists in-memory for session duration only

## Validation Rules

### add_task(title, description)

1. `title` MUST be a non-empty string (after stripping whitespace)
2. `description` MAY be empty string (default)
3. New `Task` is assigned next available ID (`_next_id`)
4. New `Task` is appended to `_tasks` list
5. `_next_id` is incremented

### update_task(task_id, title, description)

1. Task with `task_id` MUST exist in `_tasks`
2. At least one of `title` or `description` MUST be provided
3. If `title` provided, MUST be non-empty
4. Only provided fields are updated (partial updates allowed)

### delete_task(task_id)

1. Task with `task_id` MUST exist in `_tasks`
2. Task is removed from `_tasks` list
3. Return `True` if deleted, `False` if not found

### toggle_complete(task_id)

1. Task with `task_id` MUST exist in `_tasks`
2. Status is flipped: `PENDING` -> `COMPLETED`, `COMPLETED` -> `PENDING`
3. Updated task is returned

## Error Taxonomy

| Error Type | Condition | Message |
|------------|-----------|---------|
| `ValueError` | Empty title on add/update | "Title cannot be empty" |
| `KeyError` | Task not found (optional) | "Task {task_id} not found" |
| `IndexError` | Invalid ID lookup (alternative) | "Task with ID {task_id} does not exist" |
